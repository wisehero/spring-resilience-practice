### Retry Pattern 테스트 - 500 vs 503 비교

### 테스트 목적:
### 1. 503 에러는 재시도됨 (retryExceptions에 포함)
### 2. 500 에러는 재시도 안됨 (ignoreExceptions에 포함)
### 3. 로그로 재시도 횟수 확인

###
### [Phase 1] 503 에러 - Retry 동작 확인
###

### 1-1. 503 에러 발생 (재시도 3번 수행됨)
GET http://localhost:8080/api/v1/caller/test-error-503

### 예상 로그:
### - "Calling error 503 endpoint" 로그가 3번 출력됨
### - Callee에서 "503 Service Unavailable endpoint called" 3번 출력
### - 각 재시도마다 1초 간격
### - 최종적으로 Fallback 실행

###

### 1-2. Circuit 이벤트 확인
GET http://localhost:9080/actuator/circuitbreakerevents

### 예상:
### - RETRY 관련 이벤트 확인 가능
### - 3번 재시도 후 최종 실패로 기록

###
### [Phase 2] 500 에러 - Retry 하지 않음 확인
###

### 2-1. 500 에러 발생 (재시도 안함)
GET http://localhost:8080/api/v1/caller/test-error-500

### 예상 로그:
### - "Calling error 500 endpoint" 로그가 1번만 출력됨
### - Callee에서 "Error endpoint called" 1번만 출력
### - 재시도 없이 바로 Fallback 실행

###

### 2-2. Circuit 상태 확인
GET http://localhost:9080/actuator/circuitbreakers

### 503은 3번 실패로 카운트, 500은 1번 실패로 카운트됨

###
### [Phase 3] 비교 테스트 - 로그 타이밍 확인
###

### 3-1. 503 에러 호출 (재시도로 인해 약 3초 소요)
GET http://localhost:8080/api/v1/caller/test-error-503

### 시작 시간과 종료 시간을 확인하세요
### 예상: 약 3초 소요 (재시도 2번 × 1초 대기 + 처리 시간)

###

### 3-2. 500 에러 호출 (재시도 없어서 즉시 완료)
GET http://localhost:8080/api/v1/caller/test-error-500

### 시작 시간과 종료 시간을 확인하세요
### 예상: 즉시 완료 (재시도 없음)

###
### ============================================================
### 테스트 시나리오 요약
### ============================================================
###
### [검증 포인트 1] 503 에러의 Retry 동작
### - Callee 로그가 3번 출력됨 (최초 1번 + 재시도 2번)
### - 각 시도 사이에 1초 간격
### - 총 소요 시간: 약 3초
### - 최종적으로 Fallback 실행
###
### [검증 포인트 2] 500 에러는 Retry 안함
### - Callee 로그가 1번만 출력됨
### - 재시도 없이 즉시 Fallback
### - 총 소요 시간: 즉시
###
### [검증 포인트 3] Circuit Breaker와의 상호작용
### - 503: Retry 3번 모두 실패 → Circuit에 실패로 기록
### - 500: Retry 없이 1번 실패 → Circuit에 실패로 기록
### - 둘 다 Circuit 상태에 영향을 줌
###
### [예상 로그 패턴]
###
### 503 에러:
### 15:30:00 [Caller] test-error-503 호출
### 15:30:00 Calling error 503 endpoint (1차 시도)
### 15:30:01 Calling error 503 endpoint (2차 시도, 1초 후)
### 15:30:02 Calling error 503 endpoint (3차 시도, 1초 후)
### 15:30:02 ⚠️ 503 Error Fallback
###
### 500 에러:
### 15:30:05 [Caller] test-error-500 호출
### 15:30:05 Calling error 500 endpoint (1차 시도만)
### 15:30:05 ⚠️ 500 Error Fallback (즉시)
###
### ============================================================